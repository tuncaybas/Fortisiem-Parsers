<eventParser name="Sourcefire4Parser">
  <deviceType>
    <Vendor>Cisco</Vendor>
    <Model>FirePOWER</Model>
    <Version>ANY</Version>
  </deviceType>

  <patternDefinitions>
    <pattern name="patSlash"><![CDATA[[^/]+]]></pattern>
  </patternDefinitions>

  <eventFormatRecognizer><![CDATA[<:gPatMon>\s+<:gPatDay>\s+<:gPatTime>\s+<:gPatHostName>\s+SF-IMS(?:\[\d+\])?:\s]]></eventFormatRecognizer>

  <testEvents>
    <testEvent><![CDATA[<29>Jun 12 17:56:02 firepower SF-IMS[3201]: Processing blacklist file /var/sf/iprep_download/11111111-1111-1111-1111-111111111111.blf]]></testEvent>
    <testEvent><![CDATA[<29>Jun 12 17:56:02 firepower SF-IMS[3201]: Reputation entries loaded: 860, invalid: 0, re-defined: 0 (from file /var/sf/iprep_download/11111111-1111-1111-1111-111111111111.blf)]]></testEvent>
    <testEvent><![CDATA[<142>Jun 12 18:01:01 firepower SF-IMS[26875]: [26875] cgtool:cgtool [INFO] ShowRun: root </dev/cgroups>.]]></testEvent>
    <testEvent><![CDATA[<142>Jun 12 17:56:47 firepower SF-IMS[3259]: [26580] SFDataCorrelator:FileProcessing [INFO] FileProcessReconfigure: Static Analysis Engine reloaded successfully]]></testEvent>
    <testEvent><![CDATA[<142>Jun 12 16:44:14 firepower SF-IMS[3151]: [3151] sftunneld:stream_file [INFO] Initiated fstream task pulling /var/sf/iprep_download/11111111-1111-1111-1111-111111111111 from 11111111-1111-1111-1111-111111111111, task_id 974]]></testEvent>
    <testEvent><![CDATA[<142>Jun 12 17:56:02 firepower SF-IMS[3151]: [3151] sftunneld:stream_file [INFO] task_id=986]]></testEvent>
    <testEvent><![CDATA[<142>Jan  4 13:29:36 HOST-123 SF-IMS: Last message 'vpn:vpn [INFO] VPN T' repeated 1 times, suppressed by syslog-ng on HOST-123]]></testEvent>
  </testEvents>

  <parsingInstructions>
    <collectFieldsByRegex src="$_rawmsg">
      <regex><![CDATA[<_mon:gPatMon>\s+<_day:gPatDay>\s+<_time:gPatTime>\s+(?:<reptDevIpAddr:gPatIpAddr>|<reptDevName:gPatHostName>)\s+SF-IMS(?:\[<procId:gPatInt>\])?:(?:\s+\[\d+\])?\s+<_body:gPatMesgBody>]]></regex>
    </collectFieldsByRegex>
    <setEventAttribute attr="deviceTime">toDateTime($_mon, $_day, $_time)</setEventAttribute>

    <switch>
      <case>
        <collectFieldsByRegex src="$_body">
          <regex><![CDATA[^Processing blacklist file <fileName:gPatMesgBodyMin>\s*$]]></regex>
        </collectFieldsByRegex>

        <setEventAttribute attr="eventType">Sourcefire-process-blacklist</setEventAttribute>

      </case>
      <default>
        <setEventAttribute attr="eventType">Sourcefire-Generic</setEventAttribute>
        <setEventAttribute attr="msg">$_body</setEventAttribute>
      </default>
    </switch>
  </parsingInstructions>
</eventParser>
