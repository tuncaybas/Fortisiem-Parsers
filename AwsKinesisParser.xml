<eventParser name="AwsKinesisParser">
  <deviceType>
    <Vendor>Amazon</Vendor>
    <Model>AWS Kinesis</Model>
    <Version>ANY</Version>
  </deviceType>

  <testEvents>
    <testEvent><![CDATA[[FSM-AWSKinesis] Sample AWS Kinesis message]]></testEvent>
  </testEvents>

  <eventFormatRecognizer><![CDATA[\[FSM-AWSKinesis\]]]></eventFormatRecognizer>

  <parsingInstructions>
    <collectFieldsByRegex src="$_rawmsg">
      <regex><![CDATA[\[FSM-AWSKinesis\](?:\[<reptDevName:gPatStrRightSB>\]\[<reptDevIpAddr:gPatStrRightSB>\])?\s<_body:gPatMesgBody>]]></regex>
    </collectFieldsByRegex>
    <setEventAttribute attr="extEventRecvProto">AWS_KCL</setEventAttribute>
    <setEventAttribute attr="eventType">combineMsgId("AWSKinesis-Generic")</setEventAttribute>

    <!-- If the messages are compressed. Use below function to get the unzipped string.
      <setEventAttribute attr="msg">unzip($_body)</setEventAttribute>
    -->

  </parsingInstructions>
</eventParser>
