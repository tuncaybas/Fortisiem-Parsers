<eventParser name="CiscoFWSMParser">

  <deviceType>
    <Vendor>Cisco</Vendor>
    <Model>FWSM</Model>
    <Version>ANY</Version>
  </deviceType>

  <!-- pattern definitions -->
  <patternDefinitions>
    <pattern name="patMesgIdCommon"><![CDATA[FWSM]]></pattern>
    <pattern name="patMesgIdSev"><![CDATA[\d]]></pattern>
    <pattern name="patStrDoubleQuoted"><![CDATA[[^"]*]]></pattern>
    <pattern name="patStrSingleQuoted"><![CDATA[[^']*]]></pattern>
    <pattern name="patStrEndColon"><![CDATA[[^:]*]]></pattern>
    <pattern name="patStrEndSemiColon"><![CDATA[[^;]*]]></pattern>
    <pattern name="patStrRightAngle"><![CDATA[[^>]*]]></pattern>
    <pattern name="patStrRightParen"><![CDATA[[^\)]*]]></pattern>
    <pattern name="patStrEndDot"><![CDATA[[^.]*]]></pattern>
    <pattern name="patStrEndSlash"><![CDATA[[^/]*]]></pattern>
  </patternDefinitions>

  <eventFormatRecognizer><![CDATA[%FWSM-\d-\d+]]></eventFormatRecognizer>

  <testEvents>
    <testEvent><![CDATA[134>Nov 28 2007 17:20:48: %FWSM-6-302013: Built outbound TCP connection 76118 for outside:192.168.0.1/80 (192.168.0.1/80) to inside:192.168.20.31/3530 (192.168.0.2/5967)]]></testEvent>
    <testEvent><![CDATA[<134>Nov 28 2007 17:22:08: %FWSM-6-302014: Teardown TCP connection 76121 for outside:192.168.0.1/80 to inside:192.168.20.31/3531 duration 0:01:05 bytes 6410 TCP Reset-I]]></testEvent>
  </testEvents>

  <parsingInstructions>

    <!-- parsing common fields -->
    <!-- The notation "<field:patternName>" used inside regex means assigning to "field" the substring that matches the pattern specified by "patternName", later on the field can be referenced as 	"$field" in test condition or functions. The system provides a few built-in fields as described below: $_rawmsg: the whole event message $_reportIp: the reporting IP address -->

    <switch>
      <case>
        <collectFieldsByRegex src="$_rawmsg">
          <regex><![CDATA[<:gPatSyslogPRI>?<_mon:gPatMon> <_day:gPatDay> <_year:gPatYear> <_time:gPatTime>\s?: %<_idCommon:patMesgIdCommon>-<_severity:patMesgIdSev>-<_idNum:gPatInt>: <_body:gPatMesgBody>]]></regex>
        </collectFieldsByRegex>
        <setEventAttribute attr="deviceTime">toDateTime($_mon, $_day, $_year, $_time)</setEventAttribute>
      </case>

      <case>
        <collectFieldsByRegex src="$_rawmsg">
          <regex><![CDATA[<:gPatSyslogPRI>?<_mon:gPatMon> <_day:gPatDay> <_year:gPatYear> <_time:gPatTime> <_host:gPatStr>\s?: %<_idCommon:patMesgIdCommon>-<_severity:patMesgIdSev>-<_idNum:gPatInt>: <_body:gPatMesgBody>]]></regex>
        </collectFieldsByRegex>
        <setEventAttribute attr="deviceTime">toDateTime($_mon, $_day, $_year, $_time)</setEventAttribute>
        <switch>
          <case>
            <collectFieldsByRegex src="$_host">
              <regex><![CDATA[<hostIpAddr:gPatIpAddr>]]></regex>
            </collectFieldsByRegex>
            <setEventAttribute attr="reptDevIpAddr">$hostIpAddr</setEventAttribute>
          </case>
          <default>
            <setEventAttribute attr="hostName">$_host</setEventAttribute>
          </default>
        </switch>
      </case>

      <case>
        <collectFieldsByRegex src="$_rawmsg">
          <regex><![CDATA[<:gPatSyslogPRI>?<_mon:gPatMon>\s+<_day:gPatDay>\s+<_time:gPatTime>\s+<_host:gPatStr>\s+%<_idCommon:patMesgIdCommon>-<_severity:patMesgIdSev>-<_idNum:gPatInt>: <_body:gPatMesgBody>]]></regex>
        </collectFieldsByRegex>
        <setEventAttribute attr="deviceTime">toDateTime($_mon, $_day, $_time)</setEventAttribute>
        <switch>
          <case>
            <collectFieldsByRegex src="$_host">
              <regex><![CDATA[<hostIpAddr:gPatIpAddr>]]></regex>
            </collectFieldsByRegex>
            <setEventAttribute attr="reptDevIpAddr">$hostIpAddr</setEventAttribute>
          </case>
          <default>
            <setEventAttribute attr="hostName">$_host</setEventAttribute>
          </default>
        </switch>
      </case>

    </switch>

    <setEventAttribute attr="eventType">combineMsgId($_idCommon, "-", $_idNum)</setEventAttribute>
    <setEventAttribute attr="eventAction">0</setEventAttribute>
    <setEventAttribute attr="eventSeverity">1</setEventAttribute>
    <setEventAttribute attr="totFlows">1</setEventAttribute>

    <!-- event severity -->
    <choose>
      <when test="$_severity IN '6, 7'">
        <setEventAttribute attr="eventSeverity">1</setEventAttribute>
      </when>

      <when test="$_severity = '1'">
        <setEventAttribute attr="eventSeverity">10</setEventAttribute>
      </when>

      <when test="$_severity = '2'">
        <setEventAttribute attr="eventSeverity">8</setEventAttribute>
      </when>

      <when test="$_severity IN '3, 4'">
        <setEventAttribute attr="eventSeverity">5</setEventAttribute>
      </when>

      <when test="$_severity = '5'">
        <setEventAttribute attr="eventSeverity">2</setEventAttribute>
      </when>
    </choose>


    <!-- message specific parsing -->
    <choose>

      <when test="$eventType = 'FWSM-302013'">
        <!--
	    <134>Nov 28 2007 17:20:48: %FWSM-6-302013: Built outbound TCP connection 76118 for outside:192.168.0.1/80 (192.168.0.1/80) to inside:192.168.20.31/3530 (192.168.0.2/5967)
              -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Built <_direction:gPatStr> <_proto:gPatProto> connection <ipConnId:gPatInt> for <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> \(<postNATSrcIpAddr:gPatIpAddr>/<postNATSrcIpPort:gPatIpPort>\) to <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> \(<preNATDestIpAddr:gPatIpAddr>/<preNATDestIpPort:gPatIpPort>\)]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="_result">compIntfSecVal($srcIntfName, $destIntfName)</setEventAttribute>
        <!-- only need to check whether we need to swap the src and dest attributes -->
        <choose>
          <when test="$_direction = 'inbound'">
            <when test="$_result = 'GREATER'">
              <swap>$srcIntfName, $destIntfName</swap>
              <swap>$srcIpAddr, $destIpAddr</swap>
              <swap>$srcIpPort, $destIpPort</swap>
              <swap>$postNATSrcIpAddr, $preNATDestIpAddr</swap>
              <swap>$postNATSrcIpPort, $preNATDestIpPort</swap>
            </when>
          </when>
          <otherwise>
            <when test="$_result = 'LESS'">
              <swap>$srcIntfName, $destIntfName</swap>
              <swap>$srcIpAddr, $destIpAddr</swap>
              <swap>$srcIpPort, $destIpPort</swap>
              <swap>$postNATSrcIpAddr, $preNATDestIpAddr</swap>
              <swap>$postNATSrcIpPort, $preNATDestIpPort</swap>
            </when>
          </otherwise>
        </choose>

      </when>


      <when test="$eventType = 'FWSM-302014'">
        <!--
            <134>Nov 28 2007 17:22:08: %FWSM-6-302014: Teardown TCP connection 76121 for outside:192.168.0.1/80 to inside:192.168.20.31/3531 duration 0:01:05 bytes 6410 TCP Reset-I
	      -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Teardown <_proto:gPatProto> connection <ipConnId:gPatInt> for <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> to <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> duration <_connDuration:gPatTime> bytes <totBytes64:gPatInt> <:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>

        <collectAndSetAttrFromAnotherEvent AnotherEventType="FWSM-302013">
          <when test="$ipConnId = $AnotherEvent.ipConnId">
            <setEventAttribute attr="destIntfName">$AnotherEvent.destIntfName</setEventAttribute>
            <setEventAttribute attr="destIpAddr">$AnotherEvent.destIpAddr</setEventAttribute>
            <setEventAttribute attr="destIpPort">$AnotherEvent.destIpPort</setEventAttribute>
            <setEventAttribute attr="srcIntfName">$AnotherEvent.srcIntfName</setEventAttribute>
            <setEventAttribute attr="srcIpAddr">$AnotherEvent.srcIpAddr</setEventAttribute>
            <setEventAttribute attr="srcIpPort">$AnotherEvent.srcIpPort</setEventAttribute>
          </when>
        </collectAndSetAttrFromAnotherEvent>

        <setEventAttribute attr="durationMSec">calculateMSec($_connDuration)</setEventAttribute>
        <!--clasdkla =-->
      </when>


      <when test="$eventType = 'FWSM-302015'">
        <!--
            <134>Nov 28 2007 17:20:48: %FWSM-6-302015: Built outbound UDP connection 76116 for outside:192.168.0.1/53 (192.168.0.2/53) to inside:192.168.0.10/1041 (192.168.0.2/1411)
              <134>Mar 11 2008 00:11:20: %FWSM-6-302015: Built outbound UDP connection 691155 for outside:192.168.0.1/123 (192.168.0.2/123) to NP Identity Ifc:192.168.0.2/123 (192.168.0.2/123)
              -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Built <_direction:gPatStr> <_proto:gPatProto> connection <ipConnId:gPatInt> for <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> \(<postNATSrcIpAddr:gPatIpAddr>/<postNATSrcIpPort:gPatIpPort>\) to <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> \(<preNATDestIpAddr:gPatIpAddr>/<preNATDestIpPort:gPatIpPort>\)]]></regex>
        </collectAndSetAttrByRegex>

        <setEventAttribute attr="_result">compIntfSecVal($srcIntfName, $destIntfName)</setEventAttribute>
        <!-- only need to check whether we need to swap the src and dest attributes -->
        <choose>
          <when test="$_direction = 'inbound'">
            <when test="$_result = 'GREATER'">
              <swap>$srcIntfName, $destIntfName</swap>
              <swap>$srcIpAddr, $destIpAddr</swap>
              <swap>$srcIpPort, $destIpPort</swap>
              <swap>$postNATSrcIpAddr, $preNATDestIpAddr</swap>
              <swap>$postNATSrcIpPort, $preNATDestIpPort</swap>
            </when>
          </when>
          <otherwise>
            <when test="$_result = 'LESS'">
              <swap>$srcIntfName, $destIntfName</swap>
              <swap>$srcIpAddr, $destIpAddr</swap>
              <swap>$srcIpPort, $destIpPort</swap>
              <swap>$postNATSrcIpAddr, $preNATDestIpAddr</swap>
              <swap>$postNATSrcIpPort, $preNATDestIpPort</swap>
            </when>
          </otherwise>
        </choose>

      </when>


      <when test="$eventType = 'FWSM-302016'">
        <!--
            <134>Nov 28 2007 17:20:48: %FWSM-6-302016: Teardown UDP connection 76116 for outside:192.168.0.1/53 to inside:192.168.0.10/1041 duration 0:00:00 bytes 268
              <134>Mar 10 2008 23:56:17: %FWSM-6-302016: Teardown UDP connection 689300 for outside:192.168.0.1/123 to NP Identity Ifc:192.168.0.2/123 duration 0:02:01 bytes 96
              -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Teardown <_proto:gPatProto> connection <ipConnId:gPatInt> for <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> to <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> duration <_connDuration:gPatTime> bytes <totBytes64:gPatInt>]]></regex>
        </collectAndSetAttrByRegex>

        <collectAndSetAttrFromAnotherEvent AnotherEventType="FWSM-302015">
          <when test="$ipConnId = $AnotherEvent.ipConnId">
            <setEventAttribute attr="destIntfName">$AnotherEvent.destIntfName</setEventAttribute>
            <setEventAttribute attr="destIpAddr">$AnotherEvent.destIpAddr</setEventAttribute>
            <setEventAttribute attr="destIpPort">$AnotherEvent.destIpPort</setEventAttribute>
            <setEventAttribute attr="srcIntfName">$AnotherEvent.srcIntfName</setEventAttribute>
            <setEventAttribute attr="srcIpAddr">$AnotherEvent.srcIpAddr</setEventAttribute>
            <setEventAttribute attr="srcIpPort">$AnotherEvent.srcIpPort</setEventAttribute>
          </when>
        </collectAndSetAttrFromAnotherEvent>

        <setEventAttribute attr="durationMSec">calculateMSec($_connDuration)</setEventAttribute>

      </when>


      <when test="$eventType = 'FWSM-302020'">
        <!--
            From syslog-ng: May 21 2007 14:00:34: %FWSM-6-302020: Built ICMP connection for faddr 10.2.3.14/0 gaddr asa70/0 laddr asa70/0
            <134>Nov 28 2007 17:20:48: %FWSM-6-302020: Built ICMP connection for faddr 192.168.0.30/0 gaddr 192.168.0.1/0 laddr 192.168.0.1/0
              -->
        <switch>
          <case>
            <collectAndSetAttrByRegex src="$_body">
              <regex><![CDATA[Built <_proto:gPatProto> connection for faddr <srcIpAddr:gPatIpAddr>/<:gPatIpPort> gaddr <preNATDestIpAddr:gPatStr>/<:gPatIpPort> laddr <destIpAddr:gPatStr>/<icmpType:gPatIpPort>]]></regex>
            </collectAndSetAttrByRegex>
          </case>
          <case>
            <collectAndSetAttrByRegex src="$_body">
              <regex><![CDATA[Built <_direction:gPatStr> <_proto:gPatProto> connection for faddr <srcIpAddr:gPatIpAddr>/<_icmpType:gPatIpPort> gaddr <_ipAddr:gPatStr>/<:gPatIpPort> laddr <destIpAddr:gPatStr>/<icmpType:gPatIpPort>]]></regex>
            </collectAndSetAttrByRegex>
            <choose>
              <when test="$_direction = 'outbound'">
                <swap>$srcIpAddr, $destIpAddr</swap>
                <setEventAttribute attr="postNATSrcIpAddr">$_ipAddr</setEventAttribute>
                <setEventAttribute attr="icmpType">$_icmpType</setEventAttribute>
              </when>
              <otherwise>
                <setEventAttribute attr="preNATDestIpAddr">$_ipAddr</setEventAttribute>
              </otherwise>
            </choose>
          </case>
        </switch>
      </when>


      <when test="$eventType = 'FWSM-302021'">
        <!--
            <134>Nov 28 2007 17:20:50: %FWSM-6-302021: Teardown ICMP connection for faddr 192.168.0.30/0 gaddr 192.168.0.1/0 laddr 192.168.0.1/0
              -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Teardown <_proto:gPatProto> connection for faddr <srcIpAddr:gPatIpAddr>/<icmpType:gPatIpPort> gaddr <:gPatIpAddr>/<:gPatIpPort> laddr <destIpAddr:gPatIpAddr>/<:gPatIpPort>]]></regex>
        </collectAndSetAttrByRegex>
      </when>


      <when test="$eventType = 'FWSM-710005'">
        <!--
            <135>Nov 28 2007 17:21:17: %FWSM-7-710005: UDP request discarded from 192.168.0.10/138 to inside:192.168.15.255/138
              -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[<_proto:gPatProto> request discarded from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
        <setEventAttribute attr="eventSeverity">4</setEventAttribute>
      </when>


      <when test="$eventType = 'FWSM-305011'">
        <!--
            <134>Nov 28 2007 17:20:48: %FWSM-6-305011: Built dynamic TCP translation from inside:192.168.20.31/3530 to outside:192.168.0.1/5967
              <134>Nov 28 2007 17:20:48: %FWSM-6-305011: Built dynamic UDP translation from inside:192.168.0.10/1041 to outside:192.168.0.1/1411
                -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Built dynamic <_proto:gPatProto> translation from <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIntfName:patStrEndColon>:<postNATSrcIpAddr:gPatIpAddr>/<postNATSrcIpPort:gPatIpPort>]]></regex>
        </collectAndSetAttrByRegex>
      </when>


      <when test="$eventType = 'FWSM-305012'">
        <!--
            <134>Nov 28 2007 17:22:18: %FWSM-6-305012: Teardown dynamic TCP translation from inside:192.168.20.31/3530 to outside:192.168.0.1/5967 duration 0:01:30
              <134>Nov 28 2007 17:21:33: %FWSM-6-305012: Teardown dynamic UDP translation from inside:192.168.0.10/1041 to outside:192.168.0.1/1411 duration 0:00:45
                -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Teardown dynamic <_proto:gPatProto> translation from <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIntfName:patStrEndColon>:<postNATSrcIpAddr:gPatIpAddr>/<postNATSrcIpPort:gPatIpPort> duration <_connDuration:gPatTime>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-106015'">
        <!-- <134>Dec 04 2008 20:00:45: %FWSM-6-106015: Deny TCP (no connection) from 192.168.0.1/443 to 192.168.0.2/5898 flags FIN ACK on interface outside -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_proto:gPatProto> \(no connection\) from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> <:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106023'">
        <!--
            Dec 05 2008 13:02:16: %FWSM-4-106023: Deny icmp src outside:192.168.0.1 dst wdmz:192.168.0.2 (type 8, code 0) by access-group "outside-in"
            <134>Nov 28 2007 17:22:18: %FWSM-6-106023: Deny udp src inside:192.168.20.31/3530 dst outside:192.168.0.1/123 by access-group "inside_to_outside"[0x2a89d901,0x0]
              -->

        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_proto:gPatProto> <_body2:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>

        <choose>
          <when test="$_proto = 'icmp'">
            <collectAndSetAttrByRegex src="$_body2">
              <regex><![CDATA[src <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr> dst <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr> \(type <icmpType:gPatInt>, code <icmpCode:gPatInt>\)<:gPatMesgBody>]]></regex>
            </collectAndSetAttrByRegex>
          </when>
          <otherwise>
            <collectAndSetAttrByRegex src="$_body2">
              <regex><![CDATA[src <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> dst <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> <:gPatMesgBody>]]></regex>
            </collectAndSetAttrByRegex>
          </otherwise>
        </choose>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <!-- start here -->

      <when test="$eventType = 'FWSM-111001'">
        <!--
	    <133>Jul 24 2008 03:14:34: %FWSM-5-111001: Begin configuration: SJ-Dev-S-RH-VMW-01 writing to memory
	    <133>Jul 24 2008 03:14:34: %FWSM-5-111001: Begin configuration: 192.168.1.27 writing to memory
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Begin configuration: <srcIpAddr:gPatIpAddr> writing to memory<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-111004'">
        <!--
	   <133>Jul 24 2008 03:14:39: %FWSM-5-111004: SJ-Dev-S-RH-VMW-01 end configuration: OK
	   <133>Jul 24 2008 03:14:39: %FWSM-5-111004: 192.168.1.27 end configuration: OK
	   <133>Jul 24 2008 03:14:39: %FWSM-5-111004: 192.168.1.27 end configuration: FAILED
	   <133>Jul 24 2008 03:14:39: %FWSM-5-111004: console end configuration: FAILED
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[<srcIpAddr:gPatIpAddr> end configuration: <_status:gPatWord><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>

        <choose>
          <when test="$_status = 'FAILED'">
            <setEventAttribute attr="eventAction">1</setEventAttribute>
            <setEventAttribute attr="eventType">combineMsgId($_idCommon,"-",$_idNum ,"-","failure")</setEventAttribute>
          </when>
          <when test="$_status = 'OK'">
            <setEventAttribute attr="eventAction">0</setEventAttribute>
            <setEventAttribute attr="eventType">combineMsgId($_idCommon,"-",$_idNum ,"-","success")</setEventAttribute>
          </when>
        </choose>
      </when>

      <when test="$eventType = 'FWSM-111005'">
        <!--
	   <133>Jul 24 2008 03:14:32: %FWSM-5-111005: SJ-Dev-S-RH-VMW-01 end configuration: OK
	   <133>Jul 24 2008 03:14:32: %FWSM-5-111005: 192.168.1.27 end configuration: OK
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[<srcIpAddr:gPatIpAddr> end configuration: OK<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-111007'">
        <!--
	    <133>Jul 24 2008 03:14:07: %FWSM-5-111007: Begin configuration: SJ-Dev-S-RH-VMW-01 reading from terminal
	    <133>Jul 24 2008 03:14:07: %FWSM-5-111007: Begin configuration: 192.168.1.27 reading from terminal
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Begin configuration: <srcIpAddr:gPatIpAddr> reading from terminal<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-111008'">
        <!--
	    <133>Jul 24 2008 03:14:07: %FWSM-5-111008: User 'enable_15' executed the 'configure terminal' command.
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[User '<user:patStrSingleQuoted>' executed the '<command:patStrSingleQuoted>' command<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-315011'">
        <!--
	   <134>Jul 24 2008 03:19:07: %FWSM-6-315011: SSH session from SJ-Dev-S-RH-VMW-01 on interface inside for user "pix" terminated normally
	   <134>Jul 24 2008 03:19:07: %FWSM-6-315011: SSH session from 192.168.1.1 on interface inside for user "pix" terminated normally
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[SSH session from <srcIpAddr:gPatIpAddr> on interface <srcIntfName:gPatStr> for user "<user:patStrDoubleQuoted>" terminated normally<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="destIpPort">22</setEventAttribute>
        <setEventAttribute attr="ipProto">6</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-113004'">
        <!--
	   <134>Jul 24 2008 03:23:37: %FWSM-6-113004: AAA user authentication Successful : server =  192.168.0.40 : user = joeUser
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[AAA user authentication Successful : server =  <:gPatIpAddr>: user = <user:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-113005'">
        <!--
	   <134>Jul 24 2008 03:29:15: %FWSM-6-113005: AAA user authentication Rejected : reason = AAA failure : server = 192.168.0.40 : user = joeUser
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[AAA user authentication Rejected : reason = <:patStrEndColon>: server = <:gPatIpAddr> : user = <user:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-113008'">
        <!--
	   <134>Jul 24 2008 03:23:37: %FWSM-6-113008: AAA transaction status ACCEPT : user = joeUser
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[AAA transaction status ACCEPT : user = <user:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-611101'">
        <!--
	   <134>Jul 24 2008 03:23:37: %FWSM-6-611101: User authentication succeeded: Uname: joeUser
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[User authentication succeeded: Uname: <user:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-611102'">
        <!--
	   <134>Jul 24 2008 03:29:15: %FWSM-6-611102: User authentication failed: Uname: joeUser
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[User authentication failed: Uname: <user:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-605004'">
        <!--
	   <134>Jul 24 2008 03:29:15: %FWSM-6-605004: Login denied from SJ-Dev-S-RH-VMW-01/44206 to inside:192.168.19.1/telnet for user "joeUser"
	   <134>Jul 24 2008 03:29:15: %FWSM-6-605004: Login denied from 192.168.1.46/44206 to inside:192.168.19.1/telnet for user "joeUser"
	   <134>Jul 24 2008 03:29:15: %FWSM-6-605004: Login denied from 192.168.1.46/44206 to inside:192.168.19.1/23 for user "joeUser"
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Login denied from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <srcIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> for user "<user:patStrDoubleQuoted>"<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-605005'">
        <!--
	   <134>Jul 24 2008 03:19:06: %FWSM-6-605005: Login permitted from SJ-Dev-S-RH-VMW-01/44190 to inside:192.168.19.1/ssh for user "pix"
	   <134>Jul 24 2008 03:19:06: %FWSM-6-605005: Login permitted from 192.168.8.70/44190 to inside:192.168.19.1/ssh for user "pix"
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Login permitted from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <srcIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatStr> for user "<user:patStrDoubleQuoted>"<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>

      </when>


      <when test="$eventType = 'FWSM-502103'">
        <!--
	   <133>Jul 24 2008 03:23:37: %FWSM-5-502103: User priv level changed: Uname: enable_15 From: 1 To: 15
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[User priv level changed: Uname: <user:gPatStr> From: <:gPatInt> To: <:gPatInt><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <!-- FWSM SSL VPN Login -->
      <when test="$eventType = 'FWSM-722022'">
        <!--
	   <134>Aug  3 14:07:43 192.168.19.1 %FWSM-6-722022: Group <AnyConnPolicy> User <joeUser> IP <192.168.0.1> TCP SVC connection established with compression
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Group \<<policyName:patStrRightAngle>\> User \<<user:patStrRightAngle>\> IP \<<srcIpAddr:gPatIpAddr>\> <_proto:gPatProto><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <!-- FWSM SSL VPN Logoff -->
      <when test="$eventType = 'FWSM-722023'">
        <!--
           <134>Aug  3 16:48:26 192.168.19.1 %FWSM-6-722023: Group <AnyConnPolicy> User <joeUser> IP <192.168.0.1> UDP SVC connection terminated without compression
           <134>Aug  3 16:48:26 192.168.19.1 %FWSM-6-722023: Group <AnyConnPolicy> User <joeUser> IP <192.168.0.1> TCP SVC connection terminated with compression
        -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Group \<<policyName:patStrRightAngle>\> User \<<user:patStrRightAngle>\> IP \<<srcIpAddr:gPatIpAddr>\> <_proto:gPatProto><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <!-- partha added Sep 21 2009-->


      <when test="$eventType = 'FWSM-106001'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106001: Inbound TCP connection denied from IP_address/port to IP_address/port flags tcp_flags on interface interface_name-->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Inbound <_proto:gPatProto> connection denied from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> <:gPatStr> <:gPatStr> on interface <srcIntfName:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106002'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106002: protocol Connection denied by outbound list acl_ID src inside_address dest outside_address -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[<_proto:gPatProto> Connection denied by <_direction:gPatStr> list <:gPatStr> src <srcIpAddr:gPatIpAddr> dest <destIpAddr:gPatIpAddr><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106006'">
        <!-- <134>Dec 05 2008 13:02:16: %FWSM-2-106006: Deny inbound UDP from 20.20.20.20/9996 to 10.10.10.10/8080 on interface outside. -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_direction:gPatStr> <_proto:gPatProto> from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> <:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106007'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106007: Deny inbound UDP from outside_address/outside_port to inside_address/inside_port due to DNS {Response|Query} -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_direction:gPatStr> <_proto:gPatProto> from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> due to DNS <:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106010'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-3-106010: Deny inbound protocol src interface_name:dest_address/dest_port dst interface_name:source_address/source_port -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_direction:gPatStr> <_proto:gPatProto> <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106012'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-6-106012: Deny IP from IP_address to IP_address, IP options hex. -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny IP from <srcIpAddr:gPatIpAddr> to <destIpAddr:gPatIpAddr>,<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106013'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106013: Dropping echo request from IP_address to PAT address IP_address -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Dropping echo request from <srcIpAddr:gPatIpAddr> to PAT address <destIpAddr:gPatIpAddr><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
        <setEventAttribute attr="ipProto">1</setEventAttribute>
        <setEventAttribute attr="icmpType">8</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106014'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-3-106014: Deny inbound icmp src interface_name: IP_address dst interface_name: IP_address (type dec, code dec) -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny inbound icmp src <srcIntfName:patStrEndColon>:\s+<srcIpAddr:gPatIpAddr> dst <destIntfName:patStrEndColon>:\s+<destIpAddr:gPatIpAddr> \(type <icmpType:gPatInt>, code <icmpCode:gPatInt>\)]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
        <setEventAttribute attr="ipProto">1</setEventAttribute>
        <setEventAttribute attr="icmpType">8</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106016'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106016: Deny IP spoof from (IP_address) to IP_address on interface interface_name.-->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny IP spoof from \(<srcIpAddr:gPatIpAddr>\) to <destIpAddr:gPatIpAddr> on interface <srcIntfName:patStrEndDot>\.]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106017'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106017: Deny IP due to Land Attack from IP_address to IP_address-->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny IP due to Land Attack from <srcIpAddr:gPatIpAddr> to <destIpAddr:gPatIpAddr><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106018'">
        <!-- <134>Dec 05 2008 13:02:16: %FWSM-2-106018: ICMP packet type echo denied by outbound list myAcl src 10.10.10.10 dest 20.20.20.20 -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[ICMP packet type echo denied by outbound list myAcl src <srcIpAddr:gPatIpAddr> dest <destIpAddr:gPatIpAddr>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106020'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106020: Deny IP teardrop fragment (size = number, offset = number) from IP_address to IP_address-->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny IP teardrop fragment <:gPatMesgBody> from <srcIpAddr:gPatIpAddr> to <destIpAddr:gPatIpAddr><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106021'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106021: Deny protocol reverse path check from source_address to dest_address on interface interface_name -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_proto:gPatProto> reverse path check from <srcIpAddr:gPatIpAddr> to <destIpAddr:gPatIpAddr> on interface <srcIntfName:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106022'">
        <!-- <134>Dec 04 2008 20:00:45: PIX|FWSM-2-106022: Deny protocol connection spoof from source_address to dest_address on interface interface_name -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Deny <_proto:gPatProto> connection spoof from <srcIpAddr:gPatIpAddr> to <destIpAddr:gPatIpAddr> on interface <srcIntfName:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-106100'">
        <!-- <134>Dec 04 2008 20:00:45: access-list acl_ID {permitted | denied | est-allowed} protocol interface_name/source_address(source_port) -> interface_name/dest_address(dest_port) hit-cnt number ({first hit | number-second interval}) -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[access-list <policyName:gPatStr> <_action:gPatStr> <_proto:gPatProto> <srcIntfName:patStrEndSlash>/<srcIpAddr:gPatIpAddr>\(<_sport:patStrRightParen>\) -> <destIntfName:patStrEndSlash>/<destIpAddr:gPatIpAddr>\(<_dport:patStrRightParen>\) <:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <choose>
          <when test="$_action = 'permitted'">
            <setEventAttribute attr="eventAction">0</setEventAttribute>
            <setEventAttribute attr="eventType">combineMsgId($_idCommon,"-",$_idNum ,"-","permit")</setEventAttribute>
          </when>
          <when test="$_action = 'denied'">
            <setEventAttribute attr="eventAction">1</setEventAttribute>
            <setEventAttribute attr="eventType">combineMsgId($_idCommon,"-",$_idNum ,"-","deny")</setEventAttribute>
          </when>
          <when test="$_action = 'est-allowed'">
            <setEventAttribute attr="eventAction">0</setEventAttribute>
            <setEventAttribute attr="eventType">combineMsgId($_idCommon,"-",$_idNum ,"-","permit")</setEventAttribute>
          </when>
        </choose>
      </when>

      <when test="$eventType = 'FWSM-107001'">
        <!-- %PIX|FWSM-1-107001: RIP auth failed from IP_address: version=number, type=string, mode=string, sequence=number on interface interface_name  -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[RIP auth failed from <srcIpAddr:gPatIpAddr>: <:gPatStr> <:gPatStr> <:gPatStr> <:gPatStr> on interface <srcIntfName:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-108003'">
        <!-- PIX|FWSM-2-108003: Terminating ESMTP/SMTP connection; malicious pattern detected in the mail address from source_interface:source_address/source_port to dest_interface:dest_address/dset_port. Data:string   -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Terminating ESMTP/SMTP connection; malicious pattern detected in the mail address from <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>/<_dport:patStrEndColon>\.<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-108002'">
        <!-- %PIX|FWSM-2-108002: SMTP replaced string: out source_address in inside_address data: string   -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[SMTP replaced string: "<:patStrDoubleQuoted>" <srcIpAddr:gPatIpAddr> in <srcIpAddr:gPatIpAddr><:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-108006'">
        <!-- %PIX|FWSM-7-108006: Detected ESMTP size violation from src_ifc:sip|sport to dest_ifc:dip|dport;declared size is: decl_size, actual size is act_size.   -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Detected ESMTP size violation from <srcIntfName:patStrEndColon>:<srcIpAddr:gPatIpAddr>|<_sport:gPatStr> to <destIntfName:patStrEndColon>:<destIpAddr:gPatIpAddr>|<_dport:patStrEndSemiColon>;<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-109002'">
        <!-- %PIX|FWSM-6-109002: Auth from inside_address/inside_port to outside_address/outside_port failed (server IP_address failed) on interface interface_name.   -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Auth from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> failed \(<:patStrRightParen>\) on interface <srcIntfName:patStrEndDot>\.]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-109003'">
        <!-- %PIX|FWSM-6-109003: Auth from inside_address to outside_address/outside_port failed (all servers failed) on interface interface_name.   -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Auth from <srcIpAddr:gPatIpAddr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> failed .* on interface <srcIntfName:patStrEndDot>\.]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-109005'">
        <!-- %PIX|FWSM-6-109005: Authentication succeeded for user user from inside_address/inside_port to outside_address/outside_port on interface interface_name.  -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Authentication succeeded for user <user:gPatStr> from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> on interface <srcIntfName:patStrEndDot>\.]]></regex>
        </collectAndSetAttrByRegex>
      </when>

      <when test="$eventType = 'FWSM-109006'">
        <!-- %PIX|FWSM-6-109006: Authentication failed for user user from inside_address/inside_port to outside_address/outside_port on interface interface_name.  -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Authentication failed for user <user:gPatStr> from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> on interface <srcIntfName:patStrEndDot>\.]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

      <when test="$eventType = 'FWSM-109010'">
        <!-- %PIX|FWSM-3-109010: Auth from inside_address/inside_port to outside_address/outside_port failed (too many pending auths) on interface interface_name.    -->
        <collectAndSetAttrByRegex src="$_body">
          <regex><![CDATA[Auth from <srcIpAddr:gPatIpAddr>/<_sport:gPatStr> to <destIpAddr:gPatIpAddr>/<_dport:gPatStr> failed \(too many pending auths\) on interface <srcIntfName:patStrEndColon>\.]]></regex>
        </collectAndSetAttrByRegex>
        <setEventAttribute attr="eventAction">1</setEventAttribute>
      </when>

    </choose>

    <when test="exist _proto">
      <setEventAttribute attr="ipProto">convertStrToIntIpProto($_proto)</setEventAttribute>
    </when>


    <when test="exist _dport">
      <setEventAttribute attr="destIpPort">convertStrToIntIpPort($_dport)</setEventAttribute>
    </when>

    <when test="exist _sport">
      <setEventAttribute attr="srcIpPort">convertStrToIntIpPort($_sport)</setEventAttribute>
    </when>

    <!--
    <when test='exist _saddr'>
      <setEventAttribute attr="srcIpAddr">convertHostNameToIp($_saddr)</setEventAttribute>
    </when>
    <when test='exist _daddr'>
      <setEventAttribute attr="destIpAddr">convertHostNameToIp($_daddr)</setEventAttribute>
    </when>
    -->
  </parsingInstructions>

</eventParser>
