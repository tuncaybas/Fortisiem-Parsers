<eventParser name="RuckusParser">
  <deviceType>
    <Vendor>Ruckus</Vendor>
    <Model>SmartOS WLAN Controller</Model>
    <Version>ANY</Version>
  </deviceType>

  <eventFormatRecognizer><![CDATA[SNMPv2-MIB::snmpTrapOID\.0 = OID: SNMPv2-SMI::enterprises\.25053]]></eventFormatRecognizer>

  <testEvents>
    <testEvent><![CDATA[2013-05-28 10:59:01 0.0.0.0(via UDP: [172.17.0.250]:60424) TRAP2, SNMP v2c, community public	. Cold Start Trap (0) Uptime: 0:00:00.00	DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (64408111) 7 days, 10:54:41.11	SNMPv2-MIB::snmpTrapOID.0 = OID: SNMPv2-SMI::enterprises.25053.2.2.1.1	SNMPv2-SMI::enterprises.25053.2.2.2.18 = STRING: 8c:0c:90:3b:d6:00	SNMPv2-SMI::enterprises.25053.2.2.2.1 = STRING: 2494	SNMPv2-SMI::enterprises.25053.2.2.2.2 = STRING: 321223000349	SNMPv2-SMI::enterprises.25053.2.2.2.3 = STRING: normal	SNMPv2-SMI::enterprises.25053.2.2.2.4 = STRING: environment	SNMPv2-SMI::enterprises.25053.2.2.2.6 = INTEGER: 1	SNMPv2-SMI::enterprises.25053.2.2.2.5 = STRING: Tue May 28 10:59:01 2013	SNMPv2-SMI::enterprises.25053.2.2.2.7 = STRING: AP joined	SNMPv2-SMI::enterprises.25053.2.2.2.8 = STRING: AP[NIJ-BNBPRINC1@8c:0c:90:3b:d6:00] joins with uptime [36153] s and last disconnected reason [Heartbeat Loss]]]></testEvent>
  </testEvents>

  <parsingInstructions>

    <collectFieldsByRegex src="$_rawmsg">
      <!--
      <regex><![CDATA[<_year:gPatYear>-<_mon:gPatMonNum>-<_day:gPatDay>\s*<_time:gPatTime>.*DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks:\s*\(\d+\)\s*\d+\s*days,\s*\d+:\d+:\d+\.\d+\s+<_body:gPatMesgBody>]]></regex>
      -->
      <regex><![CDATA[<_year:gPatYear>-<_mon:gPatMonNum>-<_day:gPatDay>\s+<_time:gPatTime>\s+.*DISMAN-EVENT-MIB::sysUpTimeInstance\s+=\s+Timeticks:\s+\([\d]+\)(?:\s+[\d]+\s+<:gPatStr>,)?\s+[\d]+:[\d]+:[\d]+\.[\d]+\s+<_body:gPatMesgBody>]]></regex>
    </collectFieldsByRegex>

    <setEventAttribute attr="deviceTime">toDateTime($_mon, $_day, $_year, $_time)</setEventAttribute>
    <setEventAttribute attr="eventType">"Ruckus_Generic"</setEventAttribute>
    <setEventAttribute attr="eventSeverity">1</setEventAttribute>
    <setEventAttribute attr="extEventRecvProto">Snmp Trap</setEventAttribute>

    <collectAndSetAttrByKeyValuePair sep="\t" src="$_body">
      <attrKeyMap attr="_eventType" key="SNMPv2-MIB::snmpTrapOID.0 = "/>
      <attrKeyMap attr="hostMACAddr" key="SNMPv2-SMI::enterprises.25053.2.2.2.15 = STRING: "/>
      <attrKeyMap attr="nepMACAddr" key="SNMPv2-SMI::enterprises.25053.2.2.2.18 = STRING: "/>
      <attrKeyMap attr="wlanSsid" key="SNMPv2-SMI::enterprises.25053.2.2.2.23 = STRING: "/>
      <attrKeyMap attr="wlanChannelId" key="SNMPv2-SMI::enterprises.25053.2.2.2.25 = INTEGER: "/>
      <attrKeyMap attr="errReason" key="SNMPv2-SMI::enterprises.25053.2.2.2.28 = STRING: "/>
      <attrKeyMap attr="wlanContrIpAddr" key="SNMPv2-SMI::enterprises.25053.2.2.2.30 = STRING: "/>
    </collectAndSetAttrByKeyValuePair>

    <choose>
      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.1'">
        <setEventAttribute attr="eventType">Ruckus_AP_Join_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">The AP MAC address is enclosed</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.2'">
        <setEventAttribute attr="eventType">Ruckus_SSID_Spoof_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when a SSID-spoofing rogue AP is detected</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.3'">
        <setEventAttribute attr="eventType">Ruckus_MAC_Spoof_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when a MAC-spoofing rogue AP is detected</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.4'">
        <setEventAttribute attr="eventType">Ruckus_Rogue_AP_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when a rogue AP is detected</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.5'">
        <setEventAttribute attr="eventType">Ruckus_AP_Lost_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP lost contact</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.6'">
        <setEventAttribute attr="eventType">Ruckus_AP_Lost_HeartBeat_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP lost heartbeats</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.7'">
        <setEventAttribute attr="eventType">Ruckus_Client_Auth_Fail_Block_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client fails authentication too many times in a row</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.8'">
        <setEventAttribute attr="eventType">Ruckus_AP_Reset_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP reboots</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.9'">
        <setEventAttribute attr="eventType">Ruckus_IP_Change_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when IP changes</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.10'">
        <setEventAttribute attr="eventType">Ruckus_System_Cold_Start_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when system performs cold start</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.11'">
        <setEventAttribute attr="eventType">Ruckus_AP_Channel_Change_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP channel changes</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.12'">
        <setEventAttribute attr="eventType">Ruckus_Radius_Auth_Unavailable_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when RADIUS authentication server unavailable</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.13'">
        <setEventAttribute attr="eventType">Ruckus_Radius_Acct_Unavailable_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when RADIUS accounting server unavailable</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.14'">
        <setEventAttribute attr="eventType">Ruckus_Client_Join_Fail_AP_Busy_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when client fails to join because AP is busy</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.15'">
        <setEventAttribute attr="eventType">Ruckus_Interference_ADHoc_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when an interference AD hoc is detected</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.16'">
        <setEventAttribute attr="eventType">Ruckus_Image_Upgrade_Fail_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP image upgrade fails</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.22'">
        <setEventAttribute attr="eventType">Ruckus_Heartbeat_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger with trap heartbeat sent</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.24'">
        <setEventAttribute attr="eventType">Ruckus_Attacked_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when a malicious attack is detected</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.25'">
        <setEventAttribute attr="eventType">Ruckus_System_Warm_Start_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when system performs warm start</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.26'">
        <setEventAttribute attr="eventType">Ruckus_Interfere_AP_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when a rogue AP used same channel with current AP is detected</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.31'">
        <setEventAttribute attr="eventType">Ruckus_AP_System_Cold_Start_Trap_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when an AP performs cold start</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.32'">
        <setEventAttribute attr="eventType">Ruckus_AP_System_Warm_Start_Trap_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when an AP performs warm start</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.33'">
        <setEventAttribute attr="eventType">Ruckus_AP_SSID_Changed_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when an AP SSID changed</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.34'">
        <setEventAttribute attr="eventType">Ruckus_AP_Client_Exceed_Valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when online client from AP is exceed valve</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.35'">
        <setEventAttribute attr="eventType">Ruckus_AP_Available_Status_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP is available</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.36'">
        <setEventAttribute attr="eventType">Ruckus_AP_Wireless_Interface_Fault_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP wireless interface fault occurs</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.37'">
        <setEventAttribute attr="eventType">Ruckus_System_Cpu_Util_Exceed_Valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when System CPU utilization exceeds specified value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.38'">
        <setEventAttribute attr="eventType">Ruckus_System_Mem_Util_Exceed_Valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Description Trigger when system memory utilization exceeds specified value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.39'">
        <setEventAttribute attr="eventType">Ruckus_System_Bandwidth_Util_Exceed_Valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when system bandwidth utilization is exceed valve</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.40'">
        <setEventAttribute attr="eventType">Ruckus_System_Drop_Packet_Rate_Exceed_Valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when system drop packet rate exceeds specified value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.41'">
        <setEventAttribute attr="eventType">Ruckus_AP_Sync_Time_Fail_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP clock synchronization with controller fails</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.42'">
        <setEventAttribute attr="eventType">Ruckus_System_Cpu_Util_Clr_Warn_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when system CPU utilization is under the specified value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.43'">
        <setEventAttribute attr="eventType">Ruckus_System_Mem_Util_Clr_warn_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when system memory utilization is under the specified value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.60'">
        <setEventAttribute attr="eventType">Ruckus_Client_Join_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client joins an AP successfully</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.61'">
        <setEventAttribute attr="eventType">Ruckus_Client_Join_Failed_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client attempt to join an AP fail</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.62'">
        <setEventAttribute attr="eventType">Ruckus_Client_Join_Failed_AP_Busy_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when a client attempt to join an AP fails because AP is too busy</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.63'">
        <setEventAttribute attr="eventType">Ruckus_Client_Disconnect_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client disconnect from AP</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.64'">
        <setEventAttribute attr="eventType">Ruckus_Client_Roam_Out_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client roams out from AP</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.65'">
        <setEventAttribute attr="eventType">Ruckus_Client_Roam_In_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client roams in from AP</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.66'">
        <setEventAttribute attr="eventType">Ruckus_Client_Auth_Failed_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client authentication failure occurs</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.67'">
        <setEventAttribute attr="eventType">Ruckus_Client_Authorization_Failed_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when a client has no authorization to join an AP</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.83'">
        <setEventAttribute attr="eventType">Ruckus_AP_CPU_valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when AP CPU utilization exceeds value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.84'">
        <setEventAttribute attr="eventType">Ruckus_AP_MEM_valve_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Triggered when AP memory utilization exceeds value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.85'">
        <setEventAttribute attr="eventType">Ruckus_AP_CPU_valve_Clr_warn_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP CPU utilization is under the value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.86'">
        <setEventAttribute attr="eventType">Ruckus_AP_MEM_valve_Clr_warn_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when AP CPU memory is under the value</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.87'">
        <setEventAttribute attr="eventType">Ruckus_AP_Num_Sta_Exceed_Valve_Clr_warn</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when online client warning is cleared</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.88'">
        <setEventAttribute attr="eventType">Ruckus_Dhcp_Pool_Full_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when DHCP pool is full</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.89'">
        <setEventAttribute attr="eventType">Ruckus_Dhcp_Pool_Abun_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Trigger when DHCP pool is abundant</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.100'">
        <setEventAttribute attr="eventType">Ruckus_SmartRedundancy_Change_to_Active_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Smart Redundancy Peer ZoneDirector peer IP not found, system changed to active state</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.101'">
        <setEventAttribute attr="eventType">Ruckus_SmartRedundancy_Active_Connected_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Smart Redundancy connected system is in active state</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.102'">
        <setEventAttribute attr="eventType">Ruckus_SmartRedundancy_Active_Disconnected_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Smart Redundancy disconnected system is in active state</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.103'">
        <setEventAttribute attr="eventType">Ruckus_SmartRedundancy_Standby_Connected_Trap</setEventAttribute>
        <setEventAttribute attr="eventDesc">Smart Redundancy connected system is in standby state</setEventAttribute>
      </when>

      <when test="$_eventType = 'OID: SNMPv2-SMI::enterprises.25053.2.2.1.104'">
        <setEventAttribute attr="eventType">Ruckus_SmartRedundancy_Standby_Disconnected</setEventAttribute>
        <setEventAttribute attr="eventDesc">Smart Redundancy disconnected system is in standby state</setEventAttribute>
      </when>
    </choose>
  </parsingInstructions>
</eventParser>
