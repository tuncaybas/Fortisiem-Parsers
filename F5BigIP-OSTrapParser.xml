<eventParser name="F5BigIP-OSTrapParser">
  <deviceType>
    <Vendor>F5</Vendor>
    <Model>Big-IPOS</Model>
    <Version>ANY</Version>
  </deviceType>
  <eventFormatRecognizer><![CDATA[SNMPv2-SMI::enterprises.3375]]></eventFormatRecognizer>
  <testEvents>
    <testEvent><![CDATA[2012-01-18 14:13:43 0.0.0.0(via UDP: [192.168.20.243]:161) TRAP2, SNMP v2c, community public                . Cold Start Trap (0) Uptime: 0:00:00.00         DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (33131) 0:05:31.31                SNMPv2-MIB::snmpTrapOID.0 = OID: SNMPv2-SMI::enterprises.3375.2.4.0.1]]></testEvent>
  </testEvents>
  <parsingInstructions>
    <collectFieldsByRegex src="$_rawmsg">
      <regex><![CDATA[<_year:gPatYear>-<_mon:gPatMonNum>-<_day:gPatDay>\s+<_time:gPatTime>\s+<_body:gPatMesgBody>]]></regex>
    </collectFieldsByRegex>

    <setEventAttribute attr="eventType">F5-BigIP-Generic</setEventAttribute>
    <setEventAttribute attr="extEventRecvProto">Snmp Trap</setEventAttribute>

    <collectAndSetAttrByKeyValuePair sep="\t\\| SNMP" src="$_body">
      <attrKeyMap attr="_id" key="SNMPv2-MIB::snmpTrapOID.0 = OID: "/>
      <attrKeyMap attr="_bigipNotifyObjMsg" key="SNMPv2-SMI::enterprises.3375.2.4.1.1"/>
      <attrKeyMap attr="_bigipNotifyObjNode" key="SNMPv2-SMI::enterprises.3375.2.4.1.2"/>
      <attrKeyMap attr="_bigipNotifyObjPort" key="SNMPv2-SMI::enterprises.3375.2.4.1.3"/>
    </collectAndSetAttrByKeyValuePair>
    <choose>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.23'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipARPConflict"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.15'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipActive"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.16'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipActiveActive"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.3'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAgentRestart"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.2'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAgentShutdown"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.1'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAgentStart"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.22'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAggrReaperStateChange"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.92'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmBruteForceAttackDetected"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.91'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmDosAttackDetected"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.79'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmFtpRequestBlocked"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.80'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmFtpRequestViolation"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.38'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmRequestBlocked"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.39'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmRequestViolation"</setEventAttribute>
        <collectAndSetAttrByKeyValuePair sep=", " src="$_bigipNotifyObjMsg">
          <attrKeyMap attr="srcIpAddr" key="source ip: "/>
          <attrKeyMap attr="srcIpPort" key="source port: "/>
          <attrKeyMap attr="destIpAddr" key="destination ip: "/>
          <attrKeyMap attr="destIpPort" key="destination port: "/>
          <attrKeyMap attr="appName" key="HTTP classifier: "/>
          <attrKeyMap attr="infoURL" key="request: "/>
        </collectAndSetAttrByKeyValuePair>
        <when test="exist infoURL">
          <setEventAttribute attr="destName">extractHostFromURL($infoURL)</setEventAttribute>
        </when>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.85'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmSmtpRequestBlocked"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.86'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAsmSmtpRequestViolation"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.27'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipAuthFailed"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.88'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipBladeNoPower"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.90'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipBladeOffline"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.87'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipBladeTempHigh"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.8'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipChassisFanBad"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.9'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipChassisPowerSupplyBad"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.7'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipChassisTempHigh"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.89'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipClusterdNoResponse"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.35'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipCompLimitExceeded"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.28'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipConfigLoaded"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.6'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipCpuFanSpeedBad"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.5'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipCpuFanSpeedLow"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.4'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipCpuTempHigh"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.26'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipDiskPartitionGrowth"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.25'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipDiskPartitionWarn"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.37'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipExternalLinkChange"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.17'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipFeatureFailed"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.18'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipFeatureOnline"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.71'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmAppAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.72'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmAppNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.69'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmAppObjAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.70'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmAppObjNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.81'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmBig3dSslCertExpired"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.82'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmBig3dSslCertWillExpire"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.77'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmBoxAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.78'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmBoxNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.64'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmDcAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.66'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmDcDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.67'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmDcEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.65'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmDcNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.73'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmJoinedGroup"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.74'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmLeftGroup"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.44'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmLinkAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.46'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmLinkDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.47'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmLinkEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.45'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmLinkNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.40'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.42'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.43'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.52'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolMbrAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.54'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolMbrDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.55'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolMbrEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.53'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolMbrNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.41'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmPoolNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.56'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmServerAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.58'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmServerDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.59'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmServerEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.57'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmServerNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.83'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmSslCertExpired"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.84'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmSslCertWillExpire"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.60'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmVsAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.62'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmVsDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.63'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmVsEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.61'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmVsNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.48'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmWideIpAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.50'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmWideIpDisabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.51'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmWideIpEnabled"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.49'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipGtmWideIpNotAvail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.68'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipHardDiskFailure"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.76'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipInetPortExhaustion"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.20'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLicenseExpired"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.19'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLicenseFailed"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.30'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLogAlert"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.31'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLogCrit"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.29'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLogEmerg"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.32'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLogErr"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.33'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipLogWarning"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.24'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipNetLinkDown"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.12'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipNodeDown"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.13'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipNodeUp"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.34'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipPacketRejected"</setEventAttribute>
        <collectAndSetAttrByRegex src="$_bigipNotifyObjMsg">
          <regex><![CDATA[<:gPatMesgBody>\s+remote IP\s+<destIpAddr:gPatIpAddr>\s+port\s+<destIpPort:gPatInt>\s+local IP\s+<srcIpAddr:gPatIpAddr>\s+port\s+<srcIpPort:gPatInt>\s+proto\s+<ipProto:gPatStrEndColon>:<:gPatMesgBody>]]></regex>
        </collectAndSetAttrByRegex>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.10'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipServiceDown"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.11'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipServiceUp"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.36'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipSslLimitExceeded"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.75'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipStandByFail"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.14'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipStandby"</setEventAttribute>
      </when>
      <when test="$_id = 'SNMPv2-SMI::enterprises.3375.2.4.0.21'">
        <setEventAttribute attr="eventType">"F5-BigIP-bigipTamdAlert"</setEventAttribute>
      </when>
    </choose>
  </parsingInstructions>
</eventParser>
